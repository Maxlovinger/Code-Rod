(()=>{var e={};e.id=259,e.ids=[259],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7310:e=>{"use strict";e.exports=require("url")},35:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>h,pages:()=>c,routeModule:()=>x,tree:()=>n});var r=s(7096),d=s(6132),a=s(7284),l=s.n(a),o=s(2564),i={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>o[e]);s.d(t,i);let n=["",{children:["advisor",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,2927)),"/Users/max_lovinger/Documents/Code-Rod/app/advisor/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,5345)),"/Users/max_lovinger/Documents/Code-Rod/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/max_lovinger/Documents/Code-Rod/app/advisor/page.tsx"],h="/advisor/page",m={require:s,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:d.x.APP_PAGE,page:"/advisor/page",pathname:"/advisor",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:n}})},2006:(e,t,s)=>{Promise.resolve().then(s.bind(s,9612))},9612:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>AdvisorDashboard});var r=s(784),d=s(9885),a=s(2385),l=s(1672),o=s(7),i=s(6206),n=s(9546),c=s(2995),h=s(8194),m=s(3354),x=s(9708);function AdvisorDashboard(){let[e,t]=(0,d.useState)([]),[s,u]=(0,d.useState)([]),[b,g]=(0,d.useState)(!0),[w,p]=(0,d.useState)(null),[v,f]=(0,d.useState)(!1),[j,N]=(0,d.useState)(null),[y,_]=(0,d.useState)([]),[C,k]=(0,d.useState)(""),[S,A]=(0,d.useState)(""),[P,q]=(0,d.useState)(!1),[I,O]=(0,d.useState)(!1),[F,E]=(0,d.useState)("");(0,d.useEffect)(()=>{let fetchStudents=async()=>{let e=localStorage.getItem("userEmail");if(e)try{let{data:s,error:r}=await x.O.from("profiles").select("*").eq("user_type","student");console.log("All students data:",s),console.log("All students error:",r),s&&(u(s),console.log("Set all students:",s.length));let{data:d,error:a}=await x.O.from("advisor_students").select("student_id").eq("advisor_email",e);if(a){console.log("Advisor students table error:",a),t([]),g(!1);return}let l=d?.map(e=>e.student_id)||[];if(0===l.length){t([]),g(!1);return}let{data:o,error:i}=await x.O.from("profiles").select("*").in("id",l);if(i){console.error("Error fetching student profiles:",i),t([]),g(!1);return}if(o){let e=await Promise.all(o.map(async e=>{let t=e.completed_courses||[],s=t.reduce((e,t)=>e+(t.credits||0),0),{data:r}=await x.O.from("planned_courses").select("credits").eq("user_id",e.id);if(!r||0===r.length){let{data:t}=await x.O.from("planned_courses").select("credits").eq("user_email",e.email);r=t}let d=r?.reduce((e,t)=>e+(t.credits||0),0)||0,a=s+d,l={2025:"Senior",2026:"Junior",2027:"Sophomore",2028:"Freshman"}[e.class_year]||`Class of ${e.class_year}`;return{id:e.id,name:e.full_name||"Unknown Student",major:Array.isArray(e.major)?e.major.join(", "):"Undeclared",year:l,creditsCompleted:a,totalCredits:32,onTrack:a>=28,lastMeeting:e.last_meeting?new Date(e.last_meeting).toLocaleDateString():"Never"}}));t(e)}}catch(e){console.error("Failed to fetch students:",e),t([])}finally{g(!1)}};fetchStudents()},[]),(0,d.useEffect)(()=>{let fetchStudentDetails=async()=>{if(w)try{let{data:e,error:t}=await x.O.from("profiles").select("*").eq("id",w.id).single();if(t){console.error("Error fetching student details:",t);return}N(e),k(e.advisor_notes||""),A(e.last_meeting||"");let{data:s,error:r}=await x.O.from("planned_courses").select("*").eq("user_id",w.id).order("year",{ascending:!0}).order("semester",{ascending:!0});if(!s||0===s.length){let{data:t,error:d}=await x.O.from("planned_courses").select("*").eq("user_email",e.email).order("year",{ascending:!0}).order("semester",{ascending:!0});s=t,r=d}console.log("Planned courses data:",s),console.log("Planned courses error:",r),console.log("Student ID:",w.id),console.log("Student email:",e.email),!r&&s&&_(s)}catch(e){console.error("Failed to fetch student details:",e)}};fetchStudentDetails()},[w]);let addStudentToAdvisor=async()=>{if(!F)return;let e=localStorage.getItem("userEmail");if(e)try{let{error:t}=await x.O.from("advisor_students").insert({advisor_email:e,student_id:F});t?(console.error("Error adding student:",t),alert("Failed to add student. The advisor_students table may not exist yet.")):(O(!1),E(""),window.location.reload())}catch(e){console.error("Failed to add student:",e),alert("Failed to add student. The advisor_students table may not exist yet.")}},removeStudentFromAdvisor=async e=>{let t=localStorage.getItem("userEmail");if(t&&confirm("Are you sure you want to remove this student from your advisees?"))try{let{error:s}=await x.O.from("advisor_students").delete().eq("advisor_email",t).eq("student_id",e);s?(console.error("Error removing student:",s),alert("Failed to remove student")):window.location.reload()}catch(e){console.error("Failed to remove student:",e),alert("Failed to remove student")}},saveNotes=async()=>{if(!w)return;let e=localStorage.getItem("userEmail");if(e){q(!0);try{let{error:e}=await x.O.from("profiles").update({advisor_notes:C,last_meeting:S}).eq("id",w.id);e&&(console.error("Error saving notes:",e),alert("Failed to save notes"))}catch(e){console.error("Failed to save notes:",e),alert("Failed to save notes")}finally{q(!1)}}};return(0,r.jsxs)("div",{className:"min-h-screen relative overflow-hidden",children:[r.jsx(h.v,{}),r.jsx(m.t,{currentPage:"/advisor"}),r.jsx("header",{className:"relative z-10 backdrop-blur-sm bg-black/20 border-b border-white/10",children:r.jsx("div",{className:"max-w-6xl mx-auto px-6 py-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-white",children:"Advisor Dashboard"}),r.jsx("p",{className:"text-white/70 mt-1",children:"Monitor your advisees' academic progress"})]}),(0,r.jsxs)("button",{onClick:()=>O(!0),className:"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white px-6 py-2 rounded-lg font-medium transition-all duration-300 flex items-center gap-2 shadow-lg shadow-red-500/25 hover:shadow-xl hover:shadow-red-500/40 hover:scale-105 border border-red-400/30",children:[r.jsx(a.Z,{size:20}),"Add Student"]})]})})}),(0,r.jsxs)("main",{className:"relative z-10 max-w-6xl mx-auto px-6 py-8",children:[r.jsx("div",{className:"grid md:grid-cols-1 gap-6 mb-8",children:r.jsx("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-lg shadow-lg shadow-blue-500/10 p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-2xl font-bold text-white",children:e.length}),r.jsx("p",{className:"text-white/70 mt-1",children:"Total Advisees"})]}),r.jsx(l.Z,{className:"w-8 h-8 text-blue-400"})]})})}),(0,r.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg border border-white/20 rounded-lg shadow-lg shadow-red-500/10",children:[r.jsx("div",{className:"p-6 border-b border-white/20",children:(0,r.jsxs)("h2",{className:"text-xl font-semibold text-white flex items-center gap-2",children:[r.jsx(o.Z,{className:"w-5 h-5 text-purple-400"}),"Student Progress Overview"]})}),r.jsx("div",{className:"divide-y divide-white/10",children:b?r.jsx("div",{className:"p-12 text-center",children:r.jsx("p",{className:"text-white/60",children:"Loading students..."})}):0===e.length?r.jsx("div",{className:"p-12 text-center",children:r.jsx("p",{className:"text-white/60",children:"No students found"})}):e.map(e=>r.jsx("div",{className:"p-6 bg-white/5 border-b border-white/10 hover:bg-white/10 transition-colors",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("div",{className:"flex items-center mb-2",children:r.jsx("h3",{className:"text-lg font-semibold text-white",children:e.name})}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-white/70 mb-3",children:[r.jsx("span",{children:e.major}),r.jsx("span",{children:"•"}),r.jsx("span",{children:e.year}),r.jsx("span",{children:"•"}),(0,r.jsxs)("span",{children:["Last meeting: ",e.lastMeeting]})]}),r.jsx("div",{className:"flex items-center space-x-4",children:(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm text-white/70 mb-1",children:[r.jsx("span",{children:"Progress"}),(0,r.jsxs)("span",{children:[e.creditsCompleted,"/",e.totalCredits," credits"]})]}),r.jsx("div",{className:"w-full bg-white/20 rounded-full h-2 overflow-hidden",children:r.jsx("div",{className:`h-2 rounded-full transition-all duration-500 ${e.onTrack?"bg-gradient-to-r from-green-500 to-emerald-500 shadow-lg shadow-green-500/50":"bg-gradient-to-r from-red-500 to-red-600 shadow-lg shadow-red-500/50"}`,style:{width:`${e.creditsCompleted/e.totalCredits*100}%`}})})]})})]}),(0,r.jsxs)("div",{className:"ml-6 flex gap-2",children:[r.jsx("button",{onClick:()=>{p(e),f(!0)},className:"px-4 py-2 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white rounded-lg text-sm font-medium transition-all duration-300 shadow-lg shadow-red-500/25 hover:shadow-xl hover:shadow-red-500/40 hover:scale-105 border border-red-400/30",children:"View Details"}),r.jsx("button",{onClick:()=>removeStudentFromAdvisor(e.id),className:"px-3 py-2 bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white rounded-lg text-sm font-medium transition-all duration-300 shadow-lg shadow-gray-500/25 hover:shadow-xl hover:shadow-gray-500/40 hover:scale-105 border border-gray-500/30",title:"Remove student",children:r.jsx(i.Z,{size:16})})]})]})},e.id))})]})]}),v&&w&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-6 bg-black/70 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg border border-white/20 rounded-lg shadow-2xl shadow-red-500/20 max-w-3xl w-full max-h-[90vh] overflow-y-auto scrollbar-thin scrollbar-track-white/10 scrollbar-thumb-red-500/50 hover:scrollbar-thumb-red-500/70",children:[(0,r.jsxs)("div",{className:"p-6 border-b border-white/20 flex items-center justify-between sticky top-0 bg-white/10 backdrop-blur-lg",children:[(0,r.jsxs)("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-white",children:w.name}),(0,r.jsxs)("p",{className:"text-white/70 text-sm mt-1",children:[w.major," • ",w.year]})]}),r.jsx("button",{onClick:()=>{f(!1),p(null),N(null),_([]),k(""),A("")},className:"text-white/60 hover:text-white transition-colors",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[r.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Progress Overview"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-white/60 text-sm",children:"Credits Completed"}),(0,r.jsxs)("p",{className:"text-2xl font-bold text-white",children:[w.creditsCompleted,"/",w.totalCredits]})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-white/60 text-sm",children:"Status"}),r.jsx("span",{className:`inline-flex px-3 py-1 rounded-full text-sm font-medium border mt-2 ${w.onTrack?"bg-green-500/10 border-green-500/30 text-green-300":"bg-red-500/10 border-red-500/30 text-red-300"}`,children:w.onTrack?"On Track":"Needs Attention"})]})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm text-white/70 mb-2",children:[r.jsx("span",{children:"Overall Progress"}),(0,r.jsxs)("span",{children:[Math.round(w.creditsCompleted/w.totalCredits*100),"%"]})]}),r.jsx("div",{className:"w-full bg-white/20 rounded-full h-3 overflow-hidden",children:r.jsx("div",{className:`h-3 rounded-full transition-all duration-500 ${w.onTrack?"bg-gradient-to-r from-green-500 to-emerald-500 shadow-lg shadow-green-500/50":"bg-gradient-to-r from-red-500 to-red-600 shadow-lg shadow-red-500/50"}`,style:{width:`${w.creditsCompleted/w.totalCredits*100}%`}})})]})]}),j&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[r.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Contact Information"}),r.jsx("div",{className:"space-y-2",children:(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-white/60 text-sm",children:"Email"}),r.jsx("p",{className:"text-white",children:j.email||"Not provided"})]})})]}),j.completed_courses&&j.completed_courses.length>0&&(0,r.jsxs)("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[r.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Completed Courses"}),r.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:j.completed_courses.map((e,t)=>r.jsx("div",{className:"bg-white/5 rounded p-3 border border-white/10",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-white font-medium",children:e.code||"Unknown Code"}),r.jsx("p",{className:"text-white/70 text-sm",children:e.name||"Unknown Course"})]}),(0,r.jsxs)("span",{className:"text-white/60 text-sm",children:[e.credits||0," credits"]})]})},t))})]}),(0,r.jsxs)("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[r.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Additional Information"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-white/60 text-sm",children:"Class Year"}),r.jsx("p",{className:"text-white",children:j.class_year||"Not specified"})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-white/60 text-sm",children:"Last Meeting"}),r.jsx("input",{type:"date",value:S,onChange:e=>A(e.target.value),className:"w-full px-3 py-2 bg-white/5 border border-white/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/50 text-white [color-scheme:dark]"})]})]})]}),(0,r.jsxs)("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-white mb-4",children:["Long-term Course Plan (",y.length," courses)"]}),y.length>0?r.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto scrollbar-thin scrollbar-track-white/10 scrollbar-thumb-red-500/50 hover:scrollbar-thumb-red-500/70",children:y.map((e,t)=>r.jsx("div",{className:"bg-white/5 rounded p-3 border border-white/10",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-white font-medium",children:e.course_code}),r.jsx("p",{className:"text-white/70 text-sm",children:e.course_name})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("p",{className:"text-white/60 text-sm",children:[e.year," - ",e.semester]}),(0,r.jsxs)("p",{className:"text-white/60 text-sm",children:[e.credits," credits"]})]})]})},t))}):r.jsx("p",{className:"text-white/60",children:"No planned courses found"})]}),(0,r.jsxs)("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[r.jsx(n.Z,{size:20,className:"text-blue-400"}),"Advisor Notes"]}),(0,r.jsxs)("button",{onClick:saveNotes,disabled:P,className:"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-all duration-300 flex items-center gap-2 shadow-lg shadow-blue-500/25 hover:shadow-xl hover:shadow-blue-500/40 border border-blue-400/30 disabled:opacity-50",children:[r.jsx(c.Z,{size:16}),P?"Saving...":"Save Notes"]})]}),r.jsx("textarea",{value:C,onChange:e=>k(e.target.value),placeholder:"Add notes about this student's progress, meetings, concerns, etc...",className:"w-full h-32 px-4 py-3 bg-white/5 border border-white/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/50 text-white placeholder:text-white/40 resize-none"})]})]})]}),r.jsx("div",{className:"p-6 border-t border-white/20 bg-white/5",children:r.jsx("button",{onClick:()=>{f(!1),p(null),N(null),_([]),k(""),A("")},className:"w-full bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white px-6 py-3 rounded-lg font-medium transition-all duration-300 shadow-lg shadow-red-500/25 hover:shadow-xl hover:shadow-red-500/40 border border-red-400/30",children:"Close"})})]})}),I&&r.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-6",children:(0,r.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg border border-white/20 rounded-lg shadow-lg shadow-blue-500/10 max-w-md w-full",children:[r.jsx("div",{className:"p-6 border-b border-white/20",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("h2",{className:"text-xl font-bold text-white",children:"Add Student to Your Advisees"}),r.jsx("button",{onClick:()=>O(!1),className:"text-white/40 hover:text-white/70 transition-colors",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,r.jsxs)("div",{className:"p-6 space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Select Student"}),(0,r.jsxs)("select",{value:F,onChange:e=>E(e.target.value),className:"w-full px-4 py-2 bg-white/5 border border-white/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/50 text-white bg-black",children:[r.jsx("option",{value:"",children:"Choose a student"}),s.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.full_name," (",e.email,")"]},e.id))]})]}),(0,r.jsxs)("div",{className:"flex gap-3 pt-4",children:[r.jsx("button",{onClick:()=>O(!1),className:"flex-1 px-4 py-2 border border-white/20 rounded-lg hover:bg-white/5 transition-colors text-white",children:"Cancel"}),r.jsx("button",{onClick:addStudentToAdvisor,disabled:!F,className:`flex-1 px-4 py-2 rounded-lg font-medium transition-all duration-300 shadow-lg border ${F?"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white shadow-red-500/25 hover:shadow-xl hover:shadow-red-500/40 border-red-400/30 hover:scale-105":"bg-white/10 text-white/40 cursor-not-allowed border-white/20"}`,children:"Add Student"})]})]})]})})]})}},9708:(e,t,s)=>{"use strict";s.d(t,{O:()=>d});var r=s(6315);let d=(0,r.createClient)("https://nxtcvctfuajcvgapcgza.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im54dGN2Y3RmdWFqY3ZnYXBjZ3phIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMxNjE0MTQsImV4cCI6MjA3ODczNzQxNH0.QAsdwatNjr5Trv00B2AMzHbFV_5WpFTyXydcCkKZfq4")},2927:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>l,__esModule:()=>a,default:()=>i});var r=s(5153);let d=(0,r.createProxy)(String.raw`/Users/max_lovinger/Documents/Code-Rod/app/advisor/page.tsx`),{__esModule:a,$$typeof:l}=d,o=d.default,i=o}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[472,265,778,315,992,267,194,436,354],()=>__webpack_exec__(35));module.exports=s})();